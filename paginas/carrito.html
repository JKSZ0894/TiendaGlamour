<script>
  let carrito = [];
  let total = 0;

  // Función para actualizar el total y la lista del carrito
  function actualizarCarrito() {
    // Actualizar el total
    document.getElementById('total').textContent = `$${total.toLocaleString()}`;

    // Actualizar la lista del carrito
    const carritoLista = document.getElementById('carrito-lista');
    carritoLista.innerHTML = '';
    carrito.forEach(item => {
      const li = document.createElement('li');
      li.textContent = `${item.nombre} - $${item.precio.toLocaleString()} x ${item.cantidad}`;
      carritoLista.appendChild(li);
    });
  }

  // Función para añadir un producto al carrito
  function añadirAlCarrito(id, nombre, precio) {
    // Buscar si el producto ya está en el carrito
    let productoExistente = carrito.find(item => item.id === id);

    if (productoExistente) {
      // Si ya existe, aumentar la cantidad
      productoExistente.cantidad++;
    } else {
      // Si no existe, agregarlo al carrito
      carrito.push({ id, nombre, precio, cantidad: 1 });
    }

    // Actualizar el total
    total += precio;

    // Actualizar la vista del carrito
    actualizarCarrito();
  }

  // Evento para el botón de "Añadir al carrito"
  document.querySelectorAll('.añadir-carrito').forEach(boton => {
    boton.addEventListener('click', function () {
      const producto = this.closest('.producto');
      const id = producto.getAttribute('data-id');
      const nombre = producto.querySelector('h3').textContent;
      // Extraer el precio y convertirlo en número
      const precio = parseFloat(producto.querySelector('p').textContent.replace('$', '').replace('.', '').replace(',', ''));

      añadirAlCarrito(id, nombre, precio);
    });
  });

  // Evento para el botón de "Finalizar compra"
  document.getElementById('finalizar-compra').addEventListener('click', () => {
    alert('¡Gracias por tu compra!');
    carrito = [];
    total = 0;
    actualizarCarrito();
  });
</script>
